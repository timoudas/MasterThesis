gnp <- read.table("z:\\gnp.dat")
setwd("C:/Users/andreas.timoudas/Python/MasterThesis/hansen")
gnp <- read.table("z:\\gnp.dat")
setwd("C:/Users/andreas.timoudas/Python/MasterThesis/hansen")
gnp <- read.table("gnp.dat")
yg <- log(gnp[,1])
y <- (yg[2:175]-yg[1:174])*400
omit <- matrix(c(3,4),2,1)
source("tar.R")
out1 <- tar(y,5,omit,0.15,0.85,1000,1,1)
source("star.R")
out2 <- star(y,5,omit)
cat("STAR test: ", out2$s3, out2$ps3, "\n")
out2 <- star(y,5,omit)
out2
out2$s3
out2$s3, out2$ps3
out2$s3
out2$ps3
out1 <- tar(y,5,omit,0.15,0.85,1000,1,1)
out2$s3
cat("STAR test: ", out2$s3, out2$ps3, "\n")
source('../models/stationarity_tests.R')
source('../code/stationarity_tests.R')
source("tar.R")
source("tar.R")
setwd("C:/Users/andreas.timoudas/Python/MasterThesis/code")
source("tar.R")
out1 <- tar(unclass(model_data.SFI[, 'SFSI']) ,1 ,omit=0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
source('stationarity_tests.R')
norm.thresh <- list()
norm.thresh$CLIF <- (model_data.CLIFS[, 'CLIFS'] - mean(model_data.CLIFS[, 'CLIFS'])) / sd(model_data.CLIFS[, 'CLIFS'])
norm.thresh$SFSI <- (model_data.SFI[, 'SFSI'] - mean(model_data.SFI[, 'SFSI'])) / sd(model_data.SFI[, 'SFSI'])
norm.thresh$ECB <- (model_data.ECB[, 'ECBFSI'] - mean(model_data.ECB[, 'ECBFSI'])) / sd(model_data.ECB[, 'ECBFSI'])
model_data.CLIFS[, 'CLIFS'] <-  (model_data.CLIFS[, 'CLIFS'] - mean(model_data.CLIFS[, 'CLIFS'])) / sd(model_data.CLIFS[, 'CLIFS'])
model_data.SFI[, 'SFSI'] <- (model_data.SFI[, 'SFSI'] - mean(model_data.SFI[, 'SFSI'])) / sd(model_data.SFI[, 'SFSI'])
model_data.ECB[, 'ECBFSI'] <- (model_data.ECB[, 'ECBFSI'] - mean(model_data.ECB[, 'ECBFSI'])) / sd(model_data.ECB[, 'ECBFSI'])
library(tsDyn)
library(vars)
source('stationarity_tests.R')
library(remotes)
norm.thresh <- list()
norm.thresh$CLIF <- (model_data.CLIFS[, 'CLIFS'] - mean(model_data.CLIFS[, 'CLIFS'])) / sd(model_data.CLIFS[, 'CLIFS'])
norm.thresh$SFSI <- (model_data.SFI[, 'SFSI'] - mean(model_data.SFI[, 'SFSI'])) / sd(model_data.SFI[, 'SFSI'])
norm.thresh$ECB <- (model_data.ECB[, 'ECBFSI'] - mean(model_data.ECB[, 'ECBFSI'])) / sd(model_data.ECB[, 'ECBFSI'])
model_data.CLIFS[, 'CLIFS'] <-  (model_data.CLIFS[, 'CLIFS'] - mean(model_data.CLIFS[, 'CLIFS'])) / sd(model_data.CLIFS[, 'CLIFS'])
model_data.SFI[, 'SFSI'] <- (model_data.SFI[, 'SFSI'] - mean(model_data.SFI[, 'SFSI'])) / sd(model_data.SFI[, 'SFSI'])
model_data.ECB[, 'ECBFSI'] <- (model_data.ECB[, 'ECBFSI'] - mean(model_data.ECB[, 'ECBFSI'])) / sd(model_data.ECB[, 'ECBFSI'])
source('stationarity_tests.R')
norm.thresh <- list()
norm.thresh$CLIF <- (model_data.CLIFS[, 'CLIFS'] - mean(model_data.CLIFS[, 'CLIFS'])) / sd(model_data.CLIFS[, 'CLIFS'])
norm.thresh$SFSI <- (model_data.SFI[, 'SFSI'] - mean(model_data.SFI[, 'SFSI'])) / sd(model_data.SFI[, 'SFSI'])
norm.thresh$ECB <- (model_data.ECB[, 'ECBFSI'] - mean(model_data.ECB[, 'ECBFSI'])) / sd(model_data.ECB[, 'ECBFSI'])
model_data.CLIFS[, 'CLIFS'] <-  (model_data.CLIFS[, 'CLIFS'] - mean(model_data.CLIFS[, 'CLIFS'])) / sd(model_data.CLIFS[, 'CLIFS'])
model_data.SFI[, 'SFSI'] <- (model_data.SFI[, 'SFSI'] - mean(model_data.SFI[, 'SFSI'])) / sd(model_data.SFI[, 'SFSI'])
model_data.ECB[, 'ECBFSI'] <- (model_data.ECB[, 'ECBFSI'] - mean(model_data.ECB[, 'ECBFSI'])) / sd(model_data.ECB[, 'ECBFSI'])
source("tar.R")
out1 <- tar(unclass(model_data.SFI[, 'SFSI']) ,1 ,omit=0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(unclass(model_data.SFI[, 'SFSI']) ,4 ,omit=0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(unclass(model_data.SFI[, 'SFSI']) ,2 ,omit=0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(unclass(model_data.SFI[, 'SFSI']), 1 ,omit=0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
unclass(model_data.SFI[, 'SFSI']
t <- unclass(model_data.SFI[, 'SFSI']
t <- unclass(model_data.SFI[, 'SFSI'])
t
summary(t)
summary(t < 0.7)
summary(t < 0.3)
summary(t > 0.26)
summary(t > 0.23)
tvar.sfsi <- TVAR(model_data.SFI, lag=1, thDelay = 1, nthresh=1, trim = 0.15, mTh = 1, plot=TRUE, trace = TRUE)
summary(t > 0.2694938)
24 + 80
24/104
out1 <- tar(t, 1 ,omit=0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t,  ,omit=0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t, p=1 , r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t, 1, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t, 1, ,r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t, 1, 0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t, 1, 1, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t, 1, omit = 1, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t, 1, omit = 0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t, 1, omit = 1, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t, 1, omit = 0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t, 2, omit = 0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t, 3, omit = 0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(t, 4, omit = 0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
diff(t)
out1 <- tar(diff(t), 4, omit = 0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(diff(t), 1, omit = 0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(diff(t), 2, omit = 0, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(diff(t), 3, omit = 1, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
out1 <- tar(diff(t), 4, omit = 1, r1 = 0.15, r2 = 0.85, rep = 1000, 1, 1)
ADF.test(DATA_SFSI[, 'SFSI']) #NOT STATIONARY
summary(ur.kpss(diff(DATA_CLIF[, 'INT']))) #STATIONARY
summary(ur.kpss(DATA_SFSI[, 'SFSI'])) #STATIONARY
##### IN LEVELS #####
#RIKSBANKEN FSI INDEX
plot(DATA_SFSI[, 'SFSI'])
par(mar=c(1,1,1,1))
##### IN LEVELS #####
#RIKSBANKEN FSI INDEX
plot(DATA_SFSI[, 'SFSI'])
norm.thresh <- list()
norm.thresh$CLIF <- (model_data.CLIFS[, 'CLIFS'] - mean(model_data.CLIFS[, 'CLIFS'])) / sd(model_data.CLIFS[, 'CLIFS'])
norm.thresh$SFSI <- (model_data.SFI[, 'SFSI'] - mean(model_data.SFI[, 'SFSI'])) / sd(model_data.SFI[, 'SFSI'])
norm.thresh$ECB <- (model_data.ECB[, 'ECBFSI'] - mean(model_data.ECB[, 'ECBFSI'])) / sd(model_data.ECB[, 'ECBFSI'])
model_data.CLIFS[, 'CLIFS'] <-  (model_data.CLIFS[, 'CLIFS'] - mean(model_data.CLIFS[, 'CLIFS'])) / sd(model_data.CLIFS[, 'CLIFS'])
model_data.SFI[, 'SFSI'] <- (model_data.SFI[, 'SFSI'] - mean(model_data.SFI[, 'SFSI'])) / sd(model_data.SFI[, 'SFSI'])
model_data.ECB[, 'ECBFSI'] <- (model_data.ECB[, 'ECBFSI'] - mean(model_data.ECB[, 'ECBFSI'])) / sd(model_data.ECB[, 'ECBFSI'])
VARselect(model_data.SFI, lag.max = 10, type = 'const')$selection #AIC(4), BIC(1)
tsayTest(model_data.SFI[, 'SFSI'], 1) #FOLLOWS AN AR(1)
library(tsDyn)
library(vars)
source('stationarity_tests.R')
library(remotes)
norm.thresh <- list()
norm.thresh$CLIF <- (model_data.CLIFS[, 'CLIFS'] - mean(model_data.CLIFS[, 'CLIFS'])) / sd(model_data.CLIFS[, 'CLIFS'])
norm.thresh$SFSI <- (model_data.SFI[, 'SFSI'] - mean(model_data.SFI[, 'SFSI'])) / sd(model_data.SFI[, 'SFSI'])
norm.thresh$ECB <- (model_data.ECB[, 'ECBFSI'] - mean(model_data.ECB[, 'ECBFSI'])) / sd(model_data.ECB[, 'ECBFSI'])
model_data.CLIFS[, 'CLIFS'] <-  (model_data.CLIFS[, 'CLIFS'] - mean(model_data.CLIFS[, 'CLIFS'])) / sd(model_data.CLIFS[, 'CLIFS'])
model_data.SFI[, 'SFSI'] <- (model_data.SFI[, 'SFSI'] - mean(model_data.SFI[, 'SFSI'])) / sd(model_data.SFI[, 'SFSI'])
model_data.ECB[, 'ECBFSI'] <- (model_data.ECB[, 'ECBFSI'] - mean(model_data.ECB[, 'ECBFSI'])) / sd(model_data.ECB[, 'ECBFSI'])
tsayTest(model_data.SFI[, 'SFSI'], 1) #FOLLOWS AN AR(1)
suppressMessages(library(nonlinearTseries))
tsayTest(model_data.SFI[, 'SFSI'], 1) #FOLLOWS AN AR(1)
tsayTest(model_data.SFI[, 'SFSI'], 2) #FOLLOWS AN AR(2)
tsayTest(model_data.SFI[, 'SFSI'], 3) #DOES NOT FOLLOW AN AR(3)
#THRESHOLD TEST
thresholdTest(model_data.SFI[, 'SFSI'], p = 1, d = 1, lower.percent = 0.15, upper.percent = 0.85) #NS
thresholdTest(model_data.SFI[, 'SFSI'], p = 1, d = 2, lower.percent = 0.15, upper.percent = 0.85) #NS
thresholdTest(model_data.SFI[, 'SFSI'], p = 1, d = 3, lower.percent = 0.15, upper.percent = 0.85) #NS
thresholdTest(model_data.SFI[, 'SFSI'], p = 4, d = 1, lower.percent = 0.15, upper.percent = 0.85) #NS
thresholdTest(model_data.SFI[, 'SFSI'], p = 4, d = 2, lower.percent = 0.15, upper.percent = 0.85) #NS
thresholdTest(model_data.SFI[, 'SFSI'], p = 4, d = 3, lower.percent = 0.15, upper.percent = 0.85) #S
#SFSI SIGNIFICATLY DIFFERENT FROM LINEAR VAR
TVAR.LRtest(model_data.SFI, lag = 1, thDelay = 1, model = "TAR", trim = 0.15, mTh = 1, nboot=500, plot=TRUE)
tvar.sfsi <- TVAR(model_data.SFI, lag=1, thDelay = 1, nthresh=1, trim = 0.15, mTh = 1, plot=TRUE, trace = TRUE)
tvar.sfsi <- TVAR(model_data.SFI, lag=1, thDelay = 0, nthresh=1, trim = 0.15, mTh = 1, plot=TRUE, trace = TRUE)
md <- model_data.SFI[,1:-1]
md <- model_data.SFI[1]
md
md <- model_data.SFI[,1]
md
md <- model_data.SFI[1,]
md
md <- model_data.SFI[1,1]
md
md <- model_data.SFI[,1]
md
md <- model_data.SFI[,1:2]
md
md <- model_data.SFI[,2:]
md
md <- model_data.SFI[,2:4]
md
md <- model_data.SFI[,2:4]
th <- model_data.SFI[, 1]
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=0, thVar = th, trim = 0.15, mTh = 1, plot=TRUE, trace = TRUE)
md <- model_data.SFI[,2:4]
th <- model_data.SFI[, 1]
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=0, thVar = th, trim = 0.15, mTh = 1, plot=TRUE, trace = TRUE)
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=1, thVar = th, trim = 0.15, mTh = 1, plot=TRUE, trace = TRUE)
md <- model_data.SFI[,2:4]
th <- model_data.SFI[, 1]
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=1, thVar = th, trim = 0.15, plot=TRUE, trace = TRUE)
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=1, gamma = 0.3, thVar = th, trim = 0.15, plot=TRUE, trace = TRUE)
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=1, gamma = 0.3, thVar = th, trim = 0.15, plot=TRUE, trace = TRUE)
rvar
tvar
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=1, gamma = 0.3, thVar = th, trim = 0.15, plot=TRUE, trace = TRUE)
e <- resid(tvar)
cov_matrix <- t(e) %*% e
R <- chol(cov_matrix)  ## upper tri
L <-t(R)  ## lower tri
L
md <- model_data.SFI[,1:4]
th <- model_data.SFI[, 1]
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=1, gamma = 0.3, thVar = th, trim = 0.15, plot=TRUE, trace = TRUE)
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=1, thVar = th, trim = 0.15, plot=TRUE, trace = TRUE)
md <- model_data.SFI[,1:4]
th <- model_data.SFI[, 1]
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=1, thVar = th, trim = 0.15, plot=TRUE, trace = TRUE)
tvar <- TVAR(model_data.CLIFS, lag=1, nthresh=1, thDelay=1, trim = 0.15, mTh = 1, plot=TRUE, trace = TRUE)
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=1, thVar = th, trim = 0.15, plot=TRUE, trace = TRUE)
tvar <- TVAR(model_data.SFI, lag=1, nthresh=1, thDelay=1, trim = 0.15, mTh = 1, plot=TRUE, trace = TRUE)
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=1, thVar = th, trim = 0.15, plot=TRUE, trace = TRUE)
tvar <- TVAR(model_data.SFI, lag=1, nthresh=1, thDelay=1, trim = 0.15, mTh = 1, plot=TRUE, trace = TRUE)
md <- model_data.SFI[,2:4]
th <- model_data.SFI[, 1]
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=1, thVar = th, trim = 0.15, plot=TRUE, trace = TRUE)
tvar <- TVAR(model_data.SFI, lag=1, nthresh=1, thDelay=1, trim = 0.15, mTh = 1, plot=TRUE, trace = TRUE)
tvar <- TVAR(md, lag=1, nthresh=1, thDelay=1, thVar = th, trim = 0.15, plot=TRUE, trace = TRUE)
